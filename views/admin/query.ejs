<div style="margin: 0;
            padding: 0;
            background-color: #252525;
            color: white;
            width: 100%;
            min-height: 100%;">
<table border="3" style="width: 100%;">
<thead>
<tr>
<th>Name</th>
<th>Query</th>
<th style="width: 5px;">@</th>
</thead>
<tbody>
<% userQueryes.forEach(data => { %>
<tr>
<td style="word-break: break-all;"><%= data.sender%></td>
<td style="word-break: break-all;"><%= data.query%></td>
<td style="width: 5px;" onclick = 'deleteQuery("<%= data.sender%>", "<%= data.query%>", this)'>🗑️</td>
</tr>
<% }); %>
</tbody>
</table>

</div>

<script>
 const querySocket = io("/ws/dm/admin");
querySocket.on("new.query", async(data) => {
const queryCountElement = document.querySelector("#queryCount");
if(queryCountElement.innerHTML == "99+"){ return; }
let currentCount = parseInt(queryCountElement.innerHTML);
currentCount += 1;
if(currentCount > 99){
currentCount = "99+";
}
queryCountElement.innerHTML = currentCount;
console.log(data);
var tbody = document.querySelector("tbody");
var tr = document.createElement("tr");
var td1 = document.createElement("td");
td1.innerHTML = data.sender;
tr.appendChild(td1);
var td2 = document.createElement("td");
td2.innerHTML = data.query;
tr.appendChild(td2);
var td3 = document.createElement("td");
td3.onclick = `deleteQuery("${data.sender}", "${data.query}")`;
td3.innerHTML = "🗑️";
tr.appendChild(td3);
tbody.appendChild(tr);
});
function deleteQuery(name, query, btn){
console.log(name, query);
var parent = btn.parentNode.parentNode;
    parent.remove();
};
</script>
